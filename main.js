/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var g=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var u=(n,a)=>{for(var t in a)g(n,t,{get:a[t],enumerable:!0})},c=(n,a,t,e)=>{if(a&&typeof a=="object"||typeof a=="function")for(let s of d(a))!h.call(n,s)&&s!==t&&g(n,s,{get:()=>a[s],enumerable:!(e=r(a,s))||e.enumerable});return n};var w=n=>c(g({},"__esModule",{value:!0}),n);var m={};u(m,{default:()=>o});module.exports=w(m);var i=require("obsidian"),y={disableCopy:!0,disableCut:!0,disablePaste:!0,allowImages:!0,allowEmojis:!0,allowCopyUrls:!1,allowPasteUrls:!1},o=class extends i.Plugin{constructor(){super(...arguments);this.emojiRegex=/^[\p{Emoji}\p{Emoji_Modifier}\p{Emoji_Component}\p{Emoji_Modifier_Base}\p{Emoji_Presentation}\s]+$/u;this.urlRegex=/^(https?:\/\/[^\s]+)$/i;this.handleKeyDown=t=>{if((navigator.platform.toUpperCase().indexOf("MAC")>=0?t.metaKey:t.ctrlKey)&&t.key==="c"&&this.settings.disableCopy){if(this.settings.allowCopyUrls){let l=this.getSelectedText();if(l&&this.isUrl(l))return}t.preventDefault(),t.stopPropagation(),new i.Notice("Copying is disabled in this vault")}};this.handlePaste=t=>{if(!this.settings.disablePaste)return;let e=t.clipboardData;if(e){if(this.settings.allowImages){if(e.files&&e.files.length>0)return;let s=e.types;if(s.includes("Files")||s.some(l=>l.startsWith("image/")))return}if(this.settings.allowEmojis){let s=e.getData("text/plain");if(s&&this.isOnlyEmoji(s))return}if(this.settings.allowPasteUrls){let s=e.getData("text/plain");if(s&&this.isUrl(s))return}t.preventDefault(),t.stopPropagation(),new i.Notice("Pasting text is disabled in this vault")}};this.handleCopy=t=>{if(this.settings.disableCopy){if(this.settings.allowCopyUrls){let e=this.getSelectedText();if(e&&this.isUrl(e))return}t.preventDefault(),t.stopPropagation(),new i.Notice("Copying is disabled in this vault")}};this.handleCut=t=>{this.settings.disableCut&&(t.preventDefault(),t.stopPropagation(),new i.Notice("Cutting is disabled in this vault"))}}isOnlyEmoji(t){return this.emojiRegex.test(t.trim())}isUrl(t){return this.urlRegex.test(t.trim())}getSelectedText(){let t=window.getSelection();return t?t.toString():""}async onload(){await this.loadSettings(),this.addSettingTab(new p(this.app,this)),this.registerDomEvent(document,"keydown",this.handleKeyDown,!0),this.registerDomEvent(document,"paste",this.handlePaste,!0),this.registerDomEvent(document,"copy",this.handleCopy,!0),this.registerDomEvent(document,"cut",this.handleCut,!0)}onunload(){}async loadSettings(){this.settings=Object.assign({},y,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},p=class extends i.PluginSettingTab{constructor(t,e){super(t,e);this.plugin=e}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Disable Copy Paste Settings"}),new i.Setting(t).setName("Disable copy").setDesc("Block copying text from the vault").addToggle(e=>e.setValue(this.plugin.settings.disableCopy).onChange(async s=>{this.plugin.settings.disableCopy=s,await this.plugin.saveSettings()})),new i.Setting(t).setName("Disable cut").setDesc("Block cutting text from the vault").addToggle(e=>e.setValue(this.plugin.settings.disableCut).onChange(async s=>{this.plugin.settings.disableCut=s,await this.plugin.saveSettings()})),new i.Setting(t).setName("Disable paste").setDesc("Block pasting text into the vault").addToggle(e=>e.setValue(this.plugin.settings.disablePaste).onChange(async s=>{this.plugin.settings.disablePaste=s,await this.plugin.saveSettings()})),t.createEl("h3",{text:"Exceptions (when copy is disabled)"}),new i.Setting(t).setName("Allow copying URLs").setDesc("Allow copying URLs even when copy is disabled").addToggle(e=>e.setValue(this.plugin.settings.allowCopyUrls).onChange(async s=>{this.plugin.settings.allowCopyUrls=s,await this.plugin.saveSettings()})),t.createEl("h3",{text:"Exceptions (when paste is disabled)"}),new i.Setting(t).setName("Allow images").setDesc("Allow pasting images and screenshots even when paste is disabled").addToggle(e=>e.setValue(this.plugin.settings.allowImages).onChange(async s=>{this.plugin.settings.allowImages=s,await this.plugin.saveSettings()})),new i.Setting(t).setName("Allow emojis").setDesc("Allow pasting emoji-only content even when paste is disabled").addToggle(e=>e.setValue(this.plugin.settings.allowEmojis).onChange(async s=>{this.plugin.settings.allowEmojis=s,await this.plugin.saveSettings()})),new i.Setting(t).setName("Allow pasting URLs").setDesc("Allow pasting URLs even when paste is disabled").addToggle(e=>e.setValue(this.plugin.settings.allowPasteUrls).onChange(async s=>{this.plugin.settings.allowPasteUrls=s,await this.plugin.saveSettings()}))}};
